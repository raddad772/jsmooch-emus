
// Auto-generated by spc700_core_generator.js SPC_decode_opcodes_c()
#include "spc700.h"



static void SPC700_opcode_00(struct SPC700 *cpu) { // NOP 
    cpu->regs.opc_cycles = 2;
    // INS 44 ADDR MODE 0
}


static void SPC700_opcode_01(struct SPC700 *cpu) { // TCALL 0
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65502);
    cpu->regs.PC |= SPC700_read8(cpu, 65503) << 8;
}


static void SPC700_opcode_02(struct SPC700 *cpu) { // SET1 dp.0
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 57 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR |= 0x01;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_03(struct SPC700 *cpu) { // BBS dp.0, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.TA & 1) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_04(struct SPC700 *cpu) { // OR A, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 47 ADDR MODE undefined
    cpu->regs.A |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_05(struct SPC700 *cpu) { // OR A, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 47 ADDR MODE undefined
    cpu->regs.A |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_06(struct SPC700 *cpu) { // OR A, (X)
    cpu->regs.opc_cycles = 3;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 47 ADDR MODE undefined
    cpu->regs.A |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_07(struct SPC700 *cpu) { // OR A, [dp+X]
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 47 ADDR MODE undefined
    cpu->regs.A |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_08(struct SPC700 *cpu) { // OR A, #
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 47 ADDR MODE undefined
    cpu->regs.A |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_09(struct SPC700 *cpu) { // OR dp, dp
    cpu->regs.opc_cycles = 6;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TR);
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 47 ADDR MODE undefined
    cpu->regs.TA2 |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    cpu->regs.P.N = ((cpu->regs.TA2) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_0A(struct SPC700 *cpu) { // OR1 C, m.b
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = (cpu->regs.TA >> 13) & 7;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.TA & 0x1FFF);
    // INS 48 ADDR MODE 17
    u32 mask = 1 << cpu->regs.TR;
    u32 val = (cpu->regs.TA & mask) >> cpu->regs.TR;
    val &= 0x01;
    cpu->regs.P.C |= val;
}


static void SPC700_opcode_0B(struct SPC700 *cpu) { // ASL d
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 5 ADDR MODE undefined
    cpu->regs.P.C = ((cpu->regs.TR) & 0x80) >> 7;
    cpu->regs.TR = (cpu->regs.TR << 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_0C(struct SPC700 *cpu) { // ASL !abs
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 5 ADDR MODE undefined
    cpu->regs.P.C = ((cpu->regs.TR) & 0x80) >> 7;
    cpu->regs.TR = (cpu->regs.TR << 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TR);
}


static void SPC700_opcode_0D(struct SPC700 *cpu) { // PUSH P
    cpu->regs.opc_cycles = 4;
    // INS 51 ADDR MODE null
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.P.v & 0xFF));
    cpu->regs.SP &= 0xFF;
}


static void SPC700_opcode_0E(struct SPC700 *cpu) { // TSET1 !abs
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 65 ADDR MODE undefined
    cpu->regs.P.Z = +((cpu->regs.A - cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.A - cpu->regs.TR) & 0x80) >> 7;
    cpu->regs.TR |= cpu->regs.A;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TR);
}


static void SPC700_opcode_0F(struct SPC700 *cpu) { // BRK i
    cpu->regs.opc_cycles = 8;
    // INS 17 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, cpu->regs.PC & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.P.v & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.P.I = 0;
    cpu->regs.P.B = 1;
    cpu->regs.PC = SPC700_read8(cpu, (0xFFDE) & 0xFFFF) + (SPC700_read8(cpu, ((0xFFDE) + 1) & 0xFFFF) << 8);
}


static void SPC700_opcode_10(struct SPC700 *cpu) { // BPL r
    cpu->regs.opc_cycles = 2;
    // INS 13 ADDR MODE undefined
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (!cpu->regs.P.N) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_11(struct SPC700 *cpu) { // TCALL i
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65500);
    cpu->regs.PC |= SPC700_read8(cpu, 65501) << 8;
}


static void SPC700_opcode_12(struct SPC700 *cpu) { // CLR1 dp.0
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 20 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR &= 0xFE;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_13(struct SPC700 *cpu) { // BBC dp.0
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if ((cpu->regs.TA & 1) == 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_14(struct SPC700 *cpu) { // OR A, dp+X
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.X);
    // INS 47 ADDR MODE undefined
    cpu->regs.A |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_15(struct SPC700 *cpu) { // OR A, !abs+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 47 ADDR MODE undefined
    cpu->regs.A |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_16(struct SPC700 *cpu) { // OR A, !abs+Y
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 47 ADDR MODE undefined
    cpu->regs.A |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_17(struct SPC700 *cpu) { // OR A, [dp]+Y
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 47 ADDR MODE undefined
    cpu->regs.A |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_18(struct SPC700 *cpu) { // OR dp, #imm
    cpu->regs.opc_cycles = 5;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 47 ADDR MODE undefined
    cpu->regs.TA2 |= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    cpu->regs.P.N = ((cpu->regs.TA2) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_19(struct SPC700 *cpu) { // OR (X), (Y)
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.Y);
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 47 ADDR MODE undefined
    cpu->regs.TR |= cpu->regs.TA;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.X), cpu->regs.TR);
}


static void SPC700_opcode_1A(struct SPC700 *cpu) { // DECW dp
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    // INS 30 ADDR MODE undefined
    cpu->regs.TR = (cpu->regs.TR - 1) & 0xFFFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = (cpu->regs.TR & 0x8000) >> 15;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR & 0xFF);
    SPC700_write8D(cpu, (cpu->regs.TA) + 1, ((cpu->regs.TR) >> 8) & 0xFF);
}


static void SPC700_opcode_1B(struct SPC700 *cpu) { // ASL dp+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 5 ADDR MODE undefined
    cpu->regs.P.C = ((cpu->regs.TR) & 0x80) >> 7;
    cpu->regs.TR = (cpu->regs.TR << 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_1C(struct SPC700 *cpu) { // ASL A
    cpu->regs.opc_cycles = 2;
    // INS 5 ADDR MODE undefined
    cpu->regs.P.C = ((cpu->regs.A) & 0x80) >> 7;
    cpu->regs.A = (cpu->regs.A << 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_1D(struct SPC700 *cpu) { // DEC X
    cpu->regs.opc_cycles = 2;
    // INS 29 ADDR MODE undefined
    cpu->regs.X = (cpu->regs.X - 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.X) == 0);
    cpu->regs.P.N = ((cpu->regs.X) & 0x80) >> 7;
}


static void SPC700_opcode_1E(struct SPC700 *cpu) { // CMP X, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.X - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_1F(struct SPC700 *cpu) { // JMP [!abs+X]
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = (cpu->regs.TA + cpu->regs.X) & 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, (cpu->regs.TA) & 0xFFFF) + (SPC700_read8(cpu, ((cpu->regs.TA) + 1) & 0xFFFF) << 8);
    // INS 38 ADDR MODE undefined
    cpu->regs.PC = cpu->regs.TR;
}


static void SPC700_opcode_20(struct SPC700 *cpu) { // CLRP i
    cpu->regs.opc_cycles = 2;
    // INS 22 ADDR MODE 0
    cpu->regs.P.P = 0;
    cpu->regs.P.DO = 0;
}


static void SPC700_opcode_21(struct SPC700 *cpu) { // TCALL 2
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65498);
    cpu->regs.PC |= SPC700_read8(cpu, 65499) << 8;
}


static void SPC700_opcode_22(struct SPC700 *cpu) { // SET1 dp.1
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 57 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR |= 0x02;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_23(struct SPC700 *cpu) { // BBS dp.1, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.TA & 2) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_24(struct SPC700 *cpu) { // AND A, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 3 ADDR MODE undefined
    cpu->regs.A &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_25(struct SPC700 *cpu) { // AND A, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 3 ADDR MODE undefined
    cpu->regs.A &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_26(struct SPC700 *cpu) { // AND A, (X)
    cpu->regs.opc_cycles = 3;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 3 ADDR MODE undefined
    cpu->regs.A &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_27(struct SPC700 *cpu) { // AND A, [dp+X]
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 3 ADDR MODE undefined
    cpu->regs.A &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_28(struct SPC700 *cpu) { // AND A, #imm
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 3 ADDR MODE undefined
    cpu->regs.A &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_29(struct SPC700 *cpu) { // AND dp, dp
    cpu->regs.opc_cycles = 6;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TR);
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 3 ADDR MODE undefined
    cpu->regs.TA2 &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    cpu->regs.P.N = ((cpu->regs.TA2) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_2A(struct SPC700 *cpu) { // OR1 C, /m.b
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = (cpu->regs.TA >> 13) & 7;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.TA & 0x1FFF);
    // INS 4801 ADDR MODE 17
    u32 mask = 1 << cpu->regs.TR;
    u32 val = (cpu->regs.TA & mask) >> cpu->regs.TR;
    val &= 0x01;
    cpu->regs.P.C |= (val ? 0 : 1);
}


static void SPC700_opcode_2B(struct SPC700 *cpu) { // ROL dp
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 54 ADDR MODE undefined
    u32 carry = cpu->regs.P.C;
    cpu->regs.P.C = (cpu->regs.TR & 0x80) >> 7;
    cpu->regs.TR = ((cpu->regs.TR << 1) | carry) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_2C(struct SPC700 *cpu) { // ROL !abs
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 54 ADDR MODE undefined
    u32 carry = cpu->regs.P.C;
    cpu->regs.P.C = (cpu->regs.TR & 0x80) >> 7;
    cpu->regs.TR = ((cpu->regs.TR << 1) | carry) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TR);
}


static void SPC700_opcode_2D(struct SPC700 *cpu) { // PUSH A
    cpu->regs.opc_cycles = 4;
    // INS 51 ADDR MODE null
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, cpu->regs.A);
    cpu->regs.SP &= 0xFF;
}


static void SPC700_opcode_2E(struct SPC700 *cpu) { // CBNE dp, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 19 ADDR MODE undefined
    if (cpu->regs.A != cpu->regs.TA) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_2F(struct SPC700 *cpu) { // BRA r
    cpu->regs.opc_cycles = 2;
    // INS 16 ADDR MODE undefined
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
    cpu->regs.opc_cycles += 2;
}


static void SPC700_opcode_30(struct SPC700 *cpu) { // BMI r
    cpu->regs.opc_cycles = 2;
    // INS 11 ADDR MODE undefined
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.P.N) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_31(struct SPC700 *cpu) { // TCALL 3
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65496);
    cpu->regs.PC |= SPC700_read8(cpu, 65497) << 8;
}


static void SPC700_opcode_32(struct SPC700 *cpu) { // CLR1 dp.1
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 20 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR &= 0xFD;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_33(struct SPC700 *cpu) { // BBC dp.1
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if ((cpu->regs.TA & 2) == 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_34(struct SPC700 *cpu) { // AND A, dp+X
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.X);
    // INS 3 ADDR MODE undefined
    cpu->regs.A &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_35(struct SPC700 *cpu) { // AND A, !abs+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 3 ADDR MODE undefined
    cpu->regs.A &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_36(struct SPC700 *cpu) { // AND A, !abs+Y
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 3 ADDR MODE undefined
    cpu->regs.A &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_37(struct SPC700 *cpu) { // AND A, [dp]+Y
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 3 ADDR MODE undefined
    cpu->regs.A &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_38(struct SPC700 *cpu) { // AND dp, #imm
    cpu->regs.opc_cycles = 5;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 3 ADDR MODE undefined
    cpu->regs.TA2 &= (cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    cpu->regs.P.N = ((cpu->regs.TA2) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_39(struct SPC700 *cpu) { // AND (X), (Y)
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.Y);
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 3 ADDR MODE undefined
    cpu->regs.TR &= (cpu->regs.TA);
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.X), cpu->regs.TR);
}


static void SPC700_opcode_3A(struct SPC700 *cpu) { // INCW dp
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    // INS 37 ADDR MODE undefined
    cpu->regs.TR = (cpu->regs.TR + 1) & 0xFFFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = (cpu->regs.TR & 0x8000) >> 15;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR & 0xFF);
    SPC700_write8D(cpu, (cpu->regs.TA) + 1, ((cpu->regs.TR) >> 8) & 0xFF);
}


static void SPC700_opcode_3B(struct SPC700 *cpu) { // ROL dp+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 54 ADDR MODE undefined
    u32 carry = cpu->regs.P.C;
    cpu->regs.P.C = (cpu->regs.TR & 0x80) >> 7;
    cpu->regs.TR = ((cpu->regs.TR << 1) | carry) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_3C(struct SPC700 *cpu) { // ROL A
    cpu->regs.opc_cycles = 2;
    // INS 54 ADDR MODE undefined
    u32 carry = cpu->regs.P.C;
    cpu->regs.P.C = (cpu->regs.A & 0x80) >> 7;
    cpu->regs.A = ((cpu->regs.A << 1) | carry) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_3D(struct SPC700 *cpu) { // INC X
    cpu->regs.opc_cycles = 2;
    // INS 36 ADDR MODE undefined
    cpu->regs.X = (cpu->regs.X + 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.X) == 0);
    cpu->regs.P.N = ((cpu->regs.X) & 0x80) >> 7;
}


static void SPC700_opcode_3E(struct SPC700 *cpu) { // CMP X, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.X - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_3F(struct SPC700 *cpu) { // CALL !abs
    cpu->regs.opc_cycles = 8;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    // INS 18 ADDR MODE undefined
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = cpu->regs.TA;
}


static void SPC700_opcode_40(struct SPC700 *cpu) { // SETP i
    cpu->regs.opc_cycles = 2;
    // INS 59 ADDR MODE 0
    cpu->regs.P.P = 1;
    cpu->regs.P.DO = 0x100;
}


static void SPC700_opcode_41(struct SPC700 *cpu) { // TCALL 4
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65494);
    cpu->regs.PC |= SPC700_read8(cpu, 65495) << 8;
}


static void SPC700_opcode_42(struct SPC700 *cpu) { // SET1 dp.2
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 57 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR |= 0x04;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_43(struct SPC700 *cpu) { // BBS dp.2, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.TA & 4) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_44(struct SPC700 *cpu) { // EOR A, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 34 ADDR MODE undefined
    cpu->regs.A ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_45(struct SPC700 *cpu) { // EOR A, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 34 ADDR MODE undefined
    cpu->regs.A ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_46(struct SPC700 *cpu) { // EOR A, (X)
    cpu->regs.opc_cycles = 3;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 34 ADDR MODE undefined
    cpu->regs.A ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_47(struct SPC700 *cpu) { // EOR A, [dp+X]
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 34 ADDR MODE undefined
    cpu->regs.A ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_48(struct SPC700 *cpu) { // EOR A, #imm
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 34 ADDR MODE undefined
    cpu->regs.A ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_49(struct SPC700 *cpu) { // EOR dp, dp
    cpu->regs.opc_cycles = 6;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TR);
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 34 ADDR MODE undefined
    cpu->regs.TA2 ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    cpu->regs.P.N = ((cpu->regs.TA2) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_4A(struct SPC700 *cpu) { // AND1 m.b
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = (cpu->regs.TA >> 13) & 7;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.TA & 0x1FFF);
    // INS 4 ADDR MODE 17
    u32 mask = 1 << cpu->regs.TR;
    u32 val = (cpu->regs.TA & mask) >> cpu->regs.TR;
    val &= 0x01;
    cpu->regs.P.C &= val;
}


static void SPC700_opcode_4B(struct SPC700 *cpu) { // LSR dp
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 39 ADDR MODE undefined
    cpu->regs.P.C = (cpu->regs.TR) & 0x01;
    cpu->regs.TR >>= 1;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_4C(struct SPC700 *cpu) { // LSR !abs
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 39 ADDR MODE undefined
    cpu->regs.P.C = (cpu->regs.TR) & 0x01;
    cpu->regs.TR >>= 1;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TR);
}


static void SPC700_opcode_4D(struct SPC700 *cpu) { // PUSH X
    cpu->regs.opc_cycles = 4;
    // INS 51 ADDR MODE null
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, cpu->regs.X);
    cpu->regs.SP &= 0xFF;
}


static void SPC700_opcode_4E(struct SPC700 *cpu) { // TCLR1 !abs
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 64 ADDR MODE undefined
    cpu->regs.P.Z = +((cpu->regs.A - cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.A - cpu->regs.TR) & 0x80) >> 7;
    cpu->regs.TR &= (~cpu->regs.A) & 0xFF;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TR);
}


static void SPC700_opcode_4F(struct SPC700 *cpu) { // PCALL #imm
    cpu->regs.opc_cycles = 6;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 49 ADDR MODE undefined
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = cpu->regs.TR + 0xFF00;
}


static void SPC700_opcode_50(struct SPC700 *cpu) { // BVC r
    cpu->regs.opc_cycles = 2;
    // INS 14 ADDR MODE undefined
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (!cpu->regs.P.V) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_51(struct SPC700 *cpu) { // TCALL 5
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65492);
    cpu->regs.PC |= SPC700_read8(cpu, 65493) << 8;
}


static void SPC700_opcode_52(struct SPC700 *cpu) { // CLR1 dp.2
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 20 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR &= 0xFB;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_53(struct SPC700 *cpu) { // BBC dp.2
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if ((cpu->regs.TA & 0x04) == 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_54(struct SPC700 *cpu) { // EOR A, dp+X
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.X);
    // INS 34 ADDR MODE undefined
    cpu->regs.A ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_55(struct SPC700 *cpu) { // EOR A, !abs+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 34 ADDR MODE undefined
    cpu->regs.A ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_56(struct SPC700 *cpu) { // EOR A, !abs+Y
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 34 ADDR MODE undefined
    cpu->regs.A ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_57(struct SPC700 *cpu) { // EOR A, [dp]+Y
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 34 ADDR MODE undefined
    cpu->regs.A ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_58(struct SPC700 *cpu) { // EOR dp, #imm
    cpu->regs.opc_cycles = 5;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 34 ADDR MODE undefined
    cpu->regs.TA2 ^= cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    cpu->regs.P.N = ((cpu->regs.TA2) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_59(struct SPC700 *cpu) { // EOR (X), (Y)
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.Y);
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 34 ADDR MODE undefined
    cpu->regs.TR ^= cpu->regs.TA;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.X), cpu->regs.TR);
}


static void SPC700_opcode_5A(struct SPC700 *cpu) { // CMPW 
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA+1);
    cpu->regs.TR += (cpu->regs.TA << 8);
    // INS 25 ADDR MODE undefined
    i32 z = ((cpu->regs.Y << 8) + cpu->regs.A) - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFFFF) == 0);
    cpu->regs.P.N = (z & 0x8000) >> 15;
}


static void SPC700_opcode_5B(struct SPC700 *cpu) { // LSR dp+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 39 ADDR MODE undefined
    cpu->regs.P.C = (cpu->regs.TR) & 0x01;
    cpu->regs.TR >>= 1;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_5C(struct SPC700 *cpu) { // LSR A
    cpu->regs.opc_cycles = 2;
    // INS 39 ADDR MODE undefined
    cpu->regs.P.C = (cpu->regs.A) & 0x01;
    cpu->regs.A >>= 1;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_5D(struct SPC700 *cpu) { // MOV X, A
    cpu->regs.opc_cycles = 2;
    cpu->regs.X = cpu->regs.A;
    cpu->regs.P.Z = +((cpu->regs.X) == 0);
    cpu->regs.P.N = ((cpu->regs.X) & 0x80) >> 7;
}


static void SPC700_opcode_5E(struct SPC700 *cpu) { // CMP Y, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.Y - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_5F(struct SPC700 *cpu) { // JMP !abs
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.PC = cpu->regs.TA;
}


static void SPC700_opcode_60(struct SPC700 *cpu) { // CLRC i
    cpu->regs.opc_cycles = 2;
    // INS 21 ADDR MODE 0
    cpu->regs.P.C = 0;
}


static void SPC700_opcode_61(struct SPC700 *cpu) { // TCALL 6
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65490);
    cpu->regs.PC |= SPC700_read8(cpu, 65491) << 8;
}


static void SPC700_opcode_62(struct SPC700 *cpu) { // SET1 dp.3
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 57 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR |= 0x08;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_63(struct SPC700 *cpu) { // BBS dp.3, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.TA & 8) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_64(struct SPC700 *cpu) { // CMP A, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.A - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_65(struct SPC700 *cpu) { // CMP A, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.A - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_66(struct SPC700 *cpu) { // CMP A, (X)
    cpu->regs.opc_cycles = 3;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.A - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_67(struct SPC700 *cpu) { // CMP A, [dp+X]
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.A - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_68(struct SPC700 *cpu) { // CMP A, #i
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.A - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_69(struct SPC700 *cpu) { // CMP dp, dp
    cpu->regs.opc_cycles = 6;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TR);
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.TA2 - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_6A(struct SPC700 *cpu) { // AND1 C, /m.b
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = (cpu->regs.TA >> 13) & 7;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.TA & 0x1FFF);
    // INS 401 ADDR MODE 17
    u32 mask = 1 << cpu->regs.TR;
    u32 val = (cpu->regs.TA & mask) >> cpu->regs.TR;
    val = (~val) & 0x01;
    cpu->regs.P.C &= val;
}


static void SPC700_opcode_6B(struct SPC700 *cpu) { // ROR dp
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 55 ADDR MODE undefined
    u32 carry = cpu->regs.P.C;
    cpu->regs.P.C = cpu->regs.TR& 1;
    cpu->regs.TR = (carry << 7) | (cpu->regs.TR >> 1);
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_6C(struct SPC700 *cpu) { // ROR !abs
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 55 ADDR MODE undefined
    u32 carry = cpu->regs.P.C;
    cpu->regs.P.C = cpu->regs.TR& 1;
    cpu->regs.TR = (carry << 7) | (cpu->regs.TR >> 1);
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TR);
}


static void SPC700_opcode_6D(struct SPC700 *cpu) { // PUSH Y
    cpu->regs.opc_cycles = 4;
    // INS 51 ADDR MODE null
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, cpu->regs.Y);
    cpu->regs.SP &= 0xFF;
}


static void SPC700_opcode_6E(struct SPC700 *cpu) { // DBNZ dp, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 28 ADDR MODE undefined
    cpu->regs.TA2 = (cpu->regs.TA2 - 1) & 0xFF;
    if (cpu->regs.TA2 != 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_6F(struct SPC700 *cpu) { // RET i
    cpu->regs.opc_cycles = 5;
    // INS 52 ADDR MODE 0
    cpu->regs.SP = (cpu->regs.SP + 1) & 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 0x100 + cpu->regs.SP);
    cpu->regs.SP = (cpu->regs.SP + 1) & 0xFF;
    cpu->regs.PC += SPC700_read8(cpu, 0x100 + cpu->regs.SP) << 8;
}


static void SPC700_opcode_70(struct SPC700 *cpu) { // BVS r
    cpu->regs.opc_cycles = 2;
    // INS 15 ADDR MODE undefined
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.P.V) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_71(struct SPC700 *cpu) { // TCALL 7
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65488);
    cpu->regs.PC |= SPC700_read8(cpu, 65489) << 8;
}


static void SPC700_opcode_72(struct SPC700 *cpu) { // CLR1 dp.3
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 20 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR &= 0xF7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_73(struct SPC700 *cpu) { // BBC dp.3
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if ((cpu->regs.TA & 0x08) == 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_74(struct SPC700 *cpu) { // CMP A, dp+X
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.X);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.A - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_75(struct SPC700 *cpu) { // CMP A, !abs+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.A - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_76(struct SPC700 *cpu) { // CMP A, !abs+Y
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.A - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_77(struct SPC700 *cpu) { // CMP A, [dp]+Y
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.A - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_78(struct SPC700 *cpu) { // CMP dp, #imm
    cpu->regs.opc_cycles = 5;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.TA2 - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_79(struct SPC700 *cpu) { // CMP (X), (Y)
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.Y);
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.TR - cpu->regs.TA;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_7A(struct SPC700 *cpu) { // ADDW YA, dp
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA+1);
    cpu->regs.TR += (cpu->regs.TA << 8);
    // INS 2 ADDR MODE undefined
    u32 z;
    cpu->regs.P.C = 0;
    u32 y = cpu->regs.TR & 0xFF;
    z = cpu->regs.A + y;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.A = z & 0xFF;
    y = (cpu->regs.TR >> 8) & 0xFF;
    z = cpu->regs.Y + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = ((cpu->regs.Y ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~(cpu->regs.Y ^ y)) & (cpu->regs.Y ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.Y = z & 0xFF;
    cpu->regs.P.Z = +(cpu->regs.A == 0 && cpu->regs.Y == 0);
}


static void SPC700_opcode_7B(struct SPC700 *cpu) { // ROR dp+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 55 ADDR MODE undefined
    u32 carry = cpu->regs.P.C;
    cpu->regs.P.C = cpu->regs.TR& 1;
    cpu->regs.TR = (carry << 7) | (cpu->regs.TR >> 1);
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_7C(struct SPC700 *cpu) { // ROR A
    cpu->regs.opc_cycles = 2;
    // INS 55 ADDR MODE undefined
    u32 carry = cpu->regs.P.C;
    cpu->regs.P.C = cpu->regs.A& 1;
    cpu->regs.A = (carry << 7) | (cpu->regs.A >> 1);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_7D(struct SPC700 *cpu) { // MOV A, X
    cpu->regs.opc_cycles = 2;
    cpu->regs.A = cpu->regs.X;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_7E(struct SPC700 *cpu) { // CMP Y, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.Y - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_7F(struct SPC700 *cpu) { // RET1 i
    cpu->regs.opc_cycles = 6;
    // INS 53 ADDR MODE 0
    cpu->regs.SP = (cpu->regs.SP + 1) & 0xFF;
    cpu->regs.TR = SPC700_read8(cpu, 0x100 + cpu->regs.SP);
    SPC700_P_setbyte(&cpu->regs.P, cpu->regs.TR);
    cpu->regs.SP = (cpu->regs.SP + 1) & 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 0x100 + cpu->regs.SP);
    cpu->regs.SP = (cpu->regs.SP + 1) & 0xFF;
    cpu->regs.PC += SPC700_read8(cpu, 0x100 + cpu->regs.SP) << 8;
}


static void SPC700_opcode_80(struct SPC700 *cpu) { // SETC i
    cpu->regs.opc_cycles = 2;
    // INS 58 ADDR MODE 0
    cpu->regs.P.C = 1;
}


static void SPC700_opcode_81(struct SPC700 *cpu) { // TCALL 8
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65486);
    cpu->regs.PC |= SPC700_read8(cpu, 65487) << 8;
}


static void SPC700_opcode_82(struct SPC700 *cpu) { // SET1 dp.4
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 57 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR |= 0x10;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_83(struct SPC700 *cpu) { // BBS dp.4, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.TA & 0x10) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_84(struct SPC700 *cpu) { // ADC A, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.A) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ (cpu->regs.TR ))) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_85(struct SPC700 *cpu) { // ADC !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.A) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ (cpu->regs.TR ))) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_86(struct SPC700 *cpu) { // ADC A, (X)
    cpu->regs.opc_cycles = 3;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.A) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ (cpu->regs.TR ))) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_87(struct SPC700 *cpu) { // ADC A, [dp+X]
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.A) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ (cpu->regs.TR ))) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_88(struct SPC700 *cpu) { // ADC A, #imm
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.A) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ (cpu->regs.TR ))) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_89(struct SPC700 *cpu) { // ADC dp, dp
    cpu->regs.opc_cycles = 6;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TR);
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.TA2) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.TA2) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.TA2) ^ (cpu->regs.TR ))) & ((cpu->regs.TA2) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.TA2 = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_8A(struct SPC700 *cpu) { // EOR1 C, m.b
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = (cpu->regs.TA >> 13) & 7;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.TA & 0x1FFF);
    // INS 35 ADDR MODE 17
    u32 mask = 1 << cpu->regs.TR;
    u32 val = (cpu->regs.TA & mask) >> cpu->regs.TR;
    val &= 0x01;
    cpu->regs.P.C ^= val;
}


static void SPC700_opcode_8B(struct SPC700 *cpu) { // DEC dp
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 29 ADDR MODE undefined
    cpu->regs.TR = (cpu->regs.TR - 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_8C(struct SPC700 *cpu) { // DEC !abs
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 29 ADDR MODE undefined
    cpu->regs.TR = (cpu->regs.TR - 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TR);
}


static void SPC700_opcode_8D(struct SPC700 *cpu) { // MOV Y, #imm
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.Y = cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.Y) == 0);
    cpu->regs.P.N = ((cpu->regs.Y) & 0x80) >> 7;
}


static void SPC700_opcode_8E(struct SPC700 *cpu) { // POP P
    cpu->regs.opc_cycles = 4;
    // INS 50 ADDR MODE null
    cpu->regs.SP = (cpu->regs.SP + 1) & 0xFF;
    cpu->regs.TR = SPC700_read8(cpu, 0x100 + cpu->regs.SP);
    SPC700_P_setbyte(&cpu->regs.P, cpu->regs.TR);
}


static void SPC700_opcode_8F(struct SPC700 *cpu) { // MOV d, #imm
    cpu->regs.opc_cycles = 5;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_90(struct SPC700 *cpu) { // BCC r
    cpu->regs.opc_cycles = 2;
    // INS 8 ADDR MODE undefined
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (!cpu->regs.P.C) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_91(struct SPC700 *cpu) { // TCALL 9
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65484);
    cpu->regs.PC |= SPC700_read8(cpu, 65485) << 8;
}


static void SPC700_opcode_92(struct SPC700 *cpu) { // CLR1 dp.4
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 20 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR &= 0xEF;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_93(struct SPC700 *cpu) { // BBC dp.4
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if ((cpu->regs.TA & 0x10) == 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_94(struct SPC700 *cpu) { // ADC A, dp+X
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.X);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.A) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ (cpu->regs.TR ))) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_95(struct SPC700 *cpu) { // ADC A, !abs+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.A) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ (cpu->regs.TR ))) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_96(struct SPC700 *cpu) { // ADC A, !abs+Y
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.A) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ (cpu->regs.TR ))) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_97(struct SPC700 *cpu) { // ADC A, [dp]+Y
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.A) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ (cpu->regs.TR ))) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_98(struct SPC700 *cpu) { // ADC dp, #imm
    cpu->regs.opc_cycles = 5;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.TA2) + (cpu->regs.TR) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.TA2) ^ (cpu->regs.TR) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.TA2) ^ (cpu->regs.TR ))) & ((cpu->regs.TA2) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.TA2 = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_99(struct SPC700 *cpu) { // ADC (X), (Y)
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.Y);
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 1 ADDR MODE undefined
    u32 z = (cpu->regs.TR) + (cpu->regs.TA) + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.TR) ^ (cpu->regs.TA) ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.TR) ^ (cpu->regs.TA ))) & ((cpu->regs.TR) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.TR = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    SPC700_write8D(cpu, (cpu->regs.X), cpu->regs.TR);
}


static void SPC700_opcode_9A(struct SPC700 *cpu) { // SUBW YA, dp
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA+1);
    cpu->regs.TR += (cpu->regs.TA << 8);
    // INS 62 ADDR MODE undefined
    cpu->regs.P.C = 1;
    u32 x, y, z;
    x = cpu->regs.A;
    y = (~cpu->regs.TR) & 0xFF;
    z = (x & 0xFF) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    x = cpu->regs.Y;
    cpu->regs.A = z & 0xFF;
    y = ((~cpu->regs.TR) >> 8) & 0xFF;
    z = (x & 0xFF) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = ((x ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~(x ^ y)) & (x ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.Y = z & 0xFF;
    cpu->regs.P.Z = +(cpu->regs.Y == 0 && cpu->regs.A == 0);
}


static void SPC700_opcode_9B(struct SPC700 *cpu) { // DEC dp+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 29 ADDR MODE undefined
    cpu->regs.TR = (cpu->regs.TR - 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_9C(struct SPC700 *cpu) { // DEC A
    cpu->regs.opc_cycles = 2;
    // INS 29 ADDR MODE undefined
    cpu->regs.A = (cpu->regs.A - 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_9D(struct SPC700 *cpu) { // MOV X, SP
    cpu->regs.opc_cycles = 2;
    cpu->regs.X = cpu->regs.SP;
    cpu->regs.P.Z = +((cpu->regs.X) == 0);
    cpu->regs.P.N = ((cpu->regs.X) & 0x80) >> 7;
}


static void SPC700_opcode_9E(struct SPC700 *cpu) { // DIV YA, X
    cpu->regs.opc_cycles = 12;
    u32 YA = (cpu->regs.Y << 8) + cpu->regs.A;
    cpu->regs.P.H = +((cpu->regs.Y & 15) >= (cpu->regs.X & 15));
    cpu->regs.P.V = +(cpu->regs.Y >= cpu->regs.X);
    if (cpu->regs.Y < (cpu->regs.X << 1)) {
        cpu->regs.A = (YA / cpu->regs.X) & 0xFF;
        cpu->regs.Y = (YA % cpu->regs.X) & 0xFF;
    } else {
        cpu->regs.A = (255 - ((YA - (cpu->regs.X << 9)) / (256 - cpu->regs.X))) & 0xFF;
        cpu->regs.Y = (cpu->regs.X + (YA - (cpu->regs.X << 9)) % (256 - cpu->regs.X)) & 0xFF;
    }
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_9F(struct SPC700 *cpu) { // XCN i
    cpu->regs.opc_cycles = 5;
    // INS 66 ADDR MODE 0
    cpu->regs.A = ((cpu->regs.A << 4) | (cpu->regs.A >> 4)) & 0xFF;
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_A0(struct SPC700 *cpu) { // EI i
    cpu->regs.opc_cycles = 3;
    // INS 33 ADDR MODE 0
    cpu->regs.P.I = 1;
}


static void SPC700_opcode_A1(struct SPC700 *cpu) { // TCALL 10
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65482);
    cpu->regs.PC |= SPC700_read8(cpu, 65483) << 8;
}


static void SPC700_opcode_A2(struct SPC700 *cpu) { // SET1 dp.5
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 57 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR |= 0x20;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_A3(struct SPC700 *cpu) { // BBS dp.5, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.TA & 0x20) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_A4(struct SPC700 *cpu) { // SBC A, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.A) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ y)) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_A5(struct SPC700 *cpu) { // SBC A, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.A) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ y)) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_A6(struct SPC700 *cpu) { // SBC A, (X)
    cpu->regs.opc_cycles = 3;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.A) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ y)) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_A7(struct SPC700 *cpu) { // SBC A, [dp+X]
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.A) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ y)) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_A8(struct SPC700 *cpu) { // SBC A, #imm
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.A) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ y)) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_A9(struct SPC700 *cpu) { // SBC dp, dp
    cpu->regs.opc_cycles = 6;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TR);
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.TA2) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.TA2) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.TA2) ^ y)) & ((cpu->regs.TA2) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.TA2 = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_AA(struct SPC700 *cpu) { // MOV1 C, m.b
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = (cpu->regs.TA >> 13) & 7;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.TA & 0x1FFF);
    // INS 41 ADDR MODE 17
    cpu->regs.P.C = ((cpu->regs.TA) >> (cpu->regs.TR)) & 1;
}


static void SPC700_opcode_AB(struct SPC700 *cpu) { // INC dp
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 36 ADDR MODE undefined
    cpu->regs.TR = (cpu->regs.TR + 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_AC(struct SPC700 *cpu) { // INC !abs
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 36 ADDR MODE undefined
    cpu->regs.TR = (cpu->regs.TR + 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TR);
}


static void SPC700_opcode_AD(struct SPC700 *cpu) { // CMP Y, #imm
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.Y - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_AE(struct SPC700 *cpu) { // POP A
    cpu->regs.opc_cycles = 4;
    // INS 50 ADDR MODE null
    cpu->regs.SP = (cpu->regs.SP + 1) & 0xFF;
    cpu->regs.A = SPC700_read8(cpu, 0x100 + cpu->regs.SP);
}


static void SPC700_opcode_AF(struct SPC700 *cpu) { // MOV (X)+, A
    cpu->regs.opc_cycles = 4;
    SPC700_write8D(cpu, (cpu->regs.X), cpu->regs.A);
    cpu->regs.X = (cpu->regs.X + 1) & 0xFF;
}


static void SPC700_opcode_B0(struct SPC700 *cpu) { // BCS r
    cpu->regs.opc_cycles = 2;
    // INS 9 ADDR MODE undefined
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.P.C) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_B1(struct SPC700 *cpu) { // TCALL 11
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65480);
    cpu->regs.PC |= SPC700_read8(cpu, 65481) << 8;
}


static void SPC700_opcode_B2(struct SPC700 *cpu) { // CLR1 dp.5
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 20 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR &= 0xDF;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_B3(struct SPC700 *cpu) { // BBC dp.5
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if ((cpu->regs.TA & 0x20) == 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_B4(struct SPC700 *cpu) { // SBC A, dp+X
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.X);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.A) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ y)) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_B5(struct SPC700 *cpu) { // SBC A, !abs+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.A) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ y)) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_B6(struct SPC700 *cpu) { // SBC A, !abs+Y
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA & 0xFFFF);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.A) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ y)) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_B7(struct SPC700 *cpu) { // SBC A, [dp]+Y
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    cpu->regs.TA += cpu->regs.Y;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.TA);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.A) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.A) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.A) ^ y)) & ((cpu->regs.A) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.A = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
}


static void SPC700_opcode_B8(struct SPC700 *cpu) { // SBC dp, #imm
    cpu->regs.opc_cycles = 5;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA2 = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TR) & 0xFF;
    i32 z = (cpu->regs.TA2) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.TA2) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.TA2) ^ y)) & ((cpu->regs.TA2) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.TA2 = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TA2) == 0);
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TA2);
}


static void SPC700_opcode_B9(struct SPC700 *cpu) { // SBC (X), (Y)
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.Y);
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.X);
    // INS 56 ADDR MODE undefined
    i32 y = (~cpu->regs.TA) & 0xFF;
    i32 z = (cpu->regs.TR) + y + cpu->regs.P.C;
    cpu->regs.P.C = +(z > 0xFF);
    cpu->regs.P.H = (((cpu->regs.TR) ^ y ^ z) & 0x10) >> 4;
    cpu->regs.P.V = (((~((cpu->regs.TR) ^ y)) & ((cpu->regs.TR) ^ z)) & 0x80) >> 7;
    cpu->regs.P.N = (z & 0x80) >> 7;
    cpu->regs.TR = z & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    SPC700_write8D(cpu, (cpu->regs.X), cpu->regs.TR);
}


static void SPC700_opcode_BA(struct SPC700 *cpu) { // MOVW YA, dp
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.A = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.Y = SPC700_read8D(cpu, cpu->regs.TA + 1);
    cpu->regs.P.N = (cpu->regs.Y & 0x80) >> 7;
    cpu->regs.P.Z = (!cpu->regs.A && !cpu->regs.Y);
}


static void SPC700_opcode_BB(struct SPC700 *cpu) { // INC dp+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    // INS 36 ADDR MODE undefined
    cpu->regs.TR = (cpu->regs.TR + 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.TR) == 0);
    cpu->regs.P.N = ((cpu->regs.TR) & 0x80) >> 7;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_BC(struct SPC700 *cpu) { // INC A
    cpu->regs.opc_cycles = 2;
    // INS 36 ADDR MODE undefined
    cpu->regs.A = (cpu->regs.A + 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_BD(struct SPC700 *cpu) { // MOV SP, X
    cpu->regs.opc_cycles = 2;
    cpu->regs.SP = cpu->regs.X;
}


static void SPC700_opcode_BE(struct SPC700 *cpu) { // DAS A
    cpu->regs.opc_cycles = 3;
    // INS 27 ADDR MODE 0
    if (!cpu->regs.P.C || cpu->regs.A > 0x99) {
        cpu->regs.A -= 0x60;
        cpu->regs.P.C = 0;
    }
    if (!cpu->regs.P.H || ((cpu->regs.A & 15) > 0x09)) {
        cpu->regs.A -= 0x06;
    }
    cpu->regs.A &= 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_BF(struct SPC700 *cpu) { // MOV A, (X)+
    cpu->regs.opc_cycles = 4;
    cpu->regs.A = SPC700_read8D(cpu, cpu->regs.X);
    cpu->regs.X = (cpu->regs.X + 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_C0(struct SPC700 *cpu) { // DI 
    cpu->regs.opc_cycles = 3;
    // INS 31 ADDR MODE 0
    cpu->regs.P.I = 0;
}


static void SPC700_opcode_C1(struct SPC700 *cpu) { // TCALL 12
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65478);
    cpu->regs.PC |= SPC700_read8(cpu, 65479) << 8;
}


static void SPC700_opcode_C2(struct SPC700 *cpu) { // SET1 dp.6
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 57 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR |= 0x40;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_C3(struct SPC700 *cpu) { // BBS dp.6, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.TA & 0x40) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_C4(struct SPC700 *cpu) { // MOV d, A
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.A);
}


static void SPC700_opcode_C5(struct SPC700 *cpu) { // MOV !abs, A
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.A);
}


static void SPC700_opcode_C6(struct SPC700 *cpu) { // MOV (X), A
    cpu->regs.opc_cycles = 4;
    SPC700_write8D(cpu, (cpu->regs.X), cpu->regs.A);
}


static void SPC700_opcode_C7(struct SPC700 *cpu) { // MOV [dp+X], A
    cpu->regs.opc_cycles = 7;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TA)) + (SPC700_read8D(cpu, (cpu->regs.TA) + 1) << 8);
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.A);
}


static void SPC700_opcode_C8(struct SPC700 *cpu) { // CMP X, #i
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 24 ADDR MODE undefined
    i32 z = cpu->regs.X - cpu->regs.TR;
    cpu->regs.P.C = +(z >= 0);
    cpu->regs.P.Z = +((z & 0xFF) == 0);
    cpu->regs.P.N = (z & 0x80) >> 7;
}


static void SPC700_opcode_C9(struct SPC700 *cpu) { // MOV !abs, X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.X);
}


static void SPC700_opcode_CA(struct SPC700 *cpu) { // MOV1 m.b, C
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = (cpu->regs.TA >> 13) & 7;
    cpu->regs.TA &= 0x1FFF;
    cpu->regs.TA2 = SPC700_read8(cpu, cpu->regs.TA);
    // INS 41 ADDR MODE 1
    cpu->regs.TA2 = cpu->regs.P.C ? cpu->regs.TA2 | (cpu->regs.P.C << cpu->regs.TR) : cpu->regs.TA2 & ((~(1 << cpu->regs.TR)) & 0xFF);
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TA2);
}


static void SPC700_opcode_CB(struct SPC700 *cpu) { // MOV d, Y
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.Y);
}


static void SPC700_opcode_CC(struct SPC700 *cpu) { // MOV !a, Y
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.Y);
}


static void SPC700_opcode_CD(struct SPC700 *cpu) { // MOV X, #imm
    cpu->regs.opc_cycles = 2;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.X = cpu->regs.TR;
    cpu->regs.P.Z = +((cpu->regs.X) == 0);
    cpu->regs.P.N = ((cpu->regs.X) & 0x80) >> 7;
}


static void SPC700_opcode_CE(struct SPC700 *cpu) { // POP X
    cpu->regs.opc_cycles = 4;
    // INS 50 ADDR MODE null
    cpu->regs.SP = (cpu->regs.SP + 1) & 0xFF;
    cpu->regs.X = SPC700_read8(cpu, 0x100 + cpu->regs.SP);
}


static void SPC700_opcode_CF(struct SPC700 *cpu) { // MUL YA
    cpu->regs.opc_cycles = 9;
    u32 YA = cpu->regs.Y * cpu->regs.A;
    cpu->regs.A = YA & 0xFF;
    cpu->regs.Y = (YA >> 8) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.Y) == 0);
    cpu->regs.P.N = ((cpu->regs.Y) & 0x80) >> 7;
}


static void SPC700_opcode_D0(struct SPC700 *cpu) { // BNE r
    cpu->regs.opc_cycles = 2;
    // INS 12 ADDR MODE undefined
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (!cpu->regs.P.Z) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_D1(struct SPC700 *cpu) { // TCALL 13
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65476);
    cpu->regs.PC |= SPC700_read8(cpu, 65477) << 8;
}


static void SPC700_opcode_D2(struct SPC700 *cpu) { // CLR1 dp.6
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 20 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR &= 0xBF;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_D3(struct SPC700 *cpu) { // BBC dp.6
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if ((cpu->regs.TA & 0x40) == 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_D4(struct SPC700 *cpu) { // MOV dp+X, A
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8D(cpu, (cpu->regs.TA + cpu->regs.X), cpu->regs.A);
}


static void SPC700_opcode_D5(struct SPC700 *cpu) { // MOV !abs+X, A
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.X;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.A);
}


static void SPC700_opcode_D6(struct SPC700 *cpu) { // MOV !abs+Y, A
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += cpu->regs.Y;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.A);
}


static void SPC700_opcode_D7(struct SPC700 *cpu) { // MOV [dp]+Y, A
    cpu->regs.opc_cycles = 7;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TR)) + (SPC700_read8D(cpu, (cpu->regs.TR) + 1) << 8);
    cpu->regs.TA = (cpu->regs.TA + cpu->regs.Y) & 0xFFFF;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.A);
}


static void SPC700_opcode_D8(struct SPC700 *cpu) { // MOV dp, X
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.X);
}


static void SPC700_opcode_D9(struct SPC700 *cpu) { // MOV dp+Y, X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8D(cpu, (cpu->regs.TA + cpu->regs.Y), cpu->regs.X);
}


static void SPC700_opcode_DA(struct SPC700 *cpu) { // MOVW d, YA
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.A);
    SPC700_write8D(cpu, (cpu->regs.TA + 1), cpu->regs.Y);
}


static void SPC700_opcode_DB(struct SPC700 *cpu) { // MOV dp+X, Y
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    SPC700_write8D(cpu, (cpu->regs.TA + cpu->regs.X), cpu->regs.Y);
}


static void SPC700_opcode_DC(struct SPC700 *cpu) { // DEC Y
    cpu->regs.opc_cycles = 2;
    // INS 29 ADDR MODE undefined
    cpu->regs.Y = (cpu->regs.Y - 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.Y) == 0);
    cpu->regs.P.N = ((cpu->regs.Y) & 0x80) >> 7;
}


static void SPC700_opcode_DD(struct SPC700 *cpu) { // MOV A, Y
    cpu->regs.opc_cycles = 2;
    cpu->regs.A = cpu->regs.Y;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_DE(struct SPC700 *cpu) { // CBNE dp+X, r
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.X);
    // INS 19 ADDR MODE undefined
    if (cpu->regs.A != cpu->regs.TA) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_DF(struct SPC700 *cpu) { // DAA A
    cpu->regs.opc_cycles = 3;
    // INS 26 ADDR MODE 0
    if (cpu->regs.P.C || (cpu->regs.A > 0x99)) {
        cpu->regs.A = (cpu->regs.A + 0x60) & 0xFF;
        cpu->regs.P.C = 1;
    }
    if (cpu->regs.P.H || ((cpu->regs.A & 15) > 0x09)) {
        cpu->regs.A = (cpu->regs.A + 0x06) & 0xFF;
    }
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_E0(struct SPC700 *cpu) { // CLRV i
    cpu->regs.opc_cycles = 2;
    // INS 23 ADDR MODE 0
    cpu->regs.P.V = 0;
    cpu->regs.P.H = 0;
}


static void SPC700_opcode_E1(struct SPC700 *cpu) { // TCALL 14
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65474);
    cpu->regs.PC |= SPC700_read8(cpu, 65475) << 8;
}


static void SPC700_opcode_E2(struct SPC700 *cpu) { // SET1 dp.7
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 57 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR |= 0x80;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_E3(struct SPC700 *cpu) { // BBS dp.7, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.TA & 0x80) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_E4(struct SPC700 *cpu) { // MOV A, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.A = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_E5(struct SPC700 *cpu) { // MOV A, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.A = SPC700_read8(cpu, cpu->regs.TA);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_E6(struct SPC700 *cpu) { // MOV A, (X)
    cpu->regs.opc_cycles = 3;
    cpu->regs.A = SPC700_read8D(cpu, cpu->regs.X);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_E7(struct SPC700 *cpu) { // MOV A, [dp+X]
    cpu->regs.opc_cycles = 6;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA2 = SPC700_read8D(cpu, (cpu->regs.TA + cpu->regs.X)) + (SPC700_read8D(cpu, (cpu->regs.TA + cpu->regs.X) + 1) << 8);
    cpu->regs.A = SPC700_read8(cpu, cpu->regs.TA2);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_E8(struct SPC700 *cpu) { // MOV A, #imm
    cpu->regs.opc_cycles = 2;
    cpu->regs.A = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_E9(struct SPC700 *cpu) { // MOV X, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.X = SPC700_read8(cpu, cpu->regs.TA);
    cpu->regs.P.Z = +((cpu->regs.X) == 0);
    cpu->regs.P.N = ((cpu->regs.X) & 0x80) >> 7;
}


static void SPC700_opcode_EA(struct SPC700 *cpu) { // NOT1 m.b
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = (cpu->regs.TA >> 13) & 7;
    cpu->regs.TA &= 0x1FFF;
    cpu->regs.TA2 = SPC700_read8(cpu, cpu->regs.TA);
    // INS 45 ADDR MODE 1
    u32 mask = 1 << cpu->regs.TR;
    if (mask & cpu->regs.TA2)
        cpu->regs.TA2 &= ((~mask) & 0xFF);
    else
        cpu->regs.TA2 |= mask;
    SPC700_write8(cpu, cpu->regs.TA, cpu->regs.TA2);
}


static void SPC700_opcode_EB(struct SPC700 *cpu) { // MOV Y, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.Y = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.P.Z = +((cpu->regs.Y) == 0);
    cpu->regs.P.N = ((cpu->regs.Y) & 0x80) >> 7;
}


static void SPC700_opcode_EC(struct SPC700 *cpu) { // MOV Y, !abs
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.Y = SPC700_read8(cpu, cpu->regs.TA);
    cpu->regs.P.Z = +((cpu->regs.Y) == 0);
    cpu->regs.P.N = ((cpu->regs.Y) & 0x80) >> 7;
}


static void SPC700_opcode_ED(struct SPC700 *cpu) { // NOTC i
    cpu->regs.opc_cycles = 3;
    // INS 46 ADDR MODE 0
    cpu->regs.P.C = cpu->regs.P.C ? 0 : 1;
}


static void SPC700_opcode_EE(struct SPC700 *cpu) { // POP Y
    cpu->regs.opc_cycles = 4;
    // INS 50 ADDR MODE null
    cpu->regs.SP = (cpu->regs.SP + 1) & 0xFF;
    cpu->regs.Y = SPC700_read8(cpu, 0x100 + cpu->regs.SP);
}


static void SPC700_opcode_EF(struct SPC700 *cpu) { // SLEEP 
    cpu->regs.opc_cycles = 3;
    // INS 60 ADDR MODE 0
    cpu->WAI = 1;
}


static void SPC700_opcode_F0(struct SPC700 *cpu) { // BEQ r
    cpu->regs.opc_cycles = 2;
    // INS 10 ADDR MODE undefined
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if (cpu->regs.P.Z) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_F1(struct SPC700 *cpu) { // TCALL 15
    cpu->regs.opc_cycles = 8;
    // INS 63 ADDR MODE 0
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC >> 8) & 0xFF);
    cpu->regs.SP &= 0xFF;
    SPC700_write8(cpu, 0x100 + cpu->regs.SP--, (cpu->regs.PC & 0xFF));
    cpu->regs.SP &= 0xFF;
    cpu->regs.PC = SPC700_read8(cpu, 65472);
    cpu->regs.PC |= SPC700_read8(cpu, 65473) << 8;
}


static void SPC700_opcode_F2(struct SPC700 *cpu) { // CLR1 dp.7
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 20 ADDR MODE 22
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR &= 0x7F;
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_F3(struct SPC700 *cpu) { // BBC dp.n, r
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, cpu->regs.TA);
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    if ((cpu->regs.TA & 0x80) == 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_F4(struct SPC700 *cpu) { // MOV A, dp+X
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.A = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.X);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_F5(struct SPC700 *cpu) { // MOV !a+X
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.A = SPC700_read8(cpu, (cpu->regs.TA + cpu->regs.X) & 0xFFFF);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_F6(struct SPC700 *cpu) { // MOV !a+Y
    cpu->regs.opc_cycles = 5;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA += SPC700_read8(cpu, cpu->regs.PC++) << 8;
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.A = SPC700_read8(cpu, (cpu->regs.TA + cpu->regs.Y) & 0xFFFF);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_F7(struct SPC700 *cpu) { // MOV A, [dp]+Y
    cpu->regs.opc_cycles = 6;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8D(cpu, (cpu->regs.TR)) + (SPC700_read8D(cpu, (cpu->regs.TR) + 1) << 8);
    cpu->regs.TA = (cpu->regs.TA + cpu->regs.Y) & 0xFFFF;
    cpu->regs.A = SPC700_read8(cpu, cpu->regs.TA);
    cpu->regs.P.Z = +((cpu->regs.A) == 0);
    cpu->regs.P.N = ((cpu->regs.A) & 0x80) >> 7;
}


static void SPC700_opcode_F8(struct SPC700 *cpu) { // MOV X, dp
    cpu->regs.opc_cycles = 3;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.X = SPC700_read8D(cpu, cpu->regs.TR);
    cpu->regs.P.Z = +((cpu->regs.X) == 0);
    cpu->regs.P.N = ((cpu->regs.X) & 0x80) >> 7;
}


static void SPC700_opcode_F9(struct SPC700 *cpu) { // MOV X, dp+Y
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.X = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.Y);
    cpu->regs.P.Z = +((cpu->regs.X) == 0);
    cpu->regs.P.N = ((cpu->regs.X) & 0x80) >> 7;
}


static void SPC700_opcode_FA(struct SPC700 *cpu) { // MOV dp, dp
    cpu->regs.opc_cycles = 5;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.TR = SPC700_read8D(cpu, cpu->regs.TR);
    SPC700_write8D(cpu, (cpu->regs.TA), cpu->regs.TR);
}


static void SPC700_opcode_FB(struct SPC700 *cpu) { // MOV Y, dp+X
    cpu->regs.opc_cycles = 4;
    cpu->regs.TA = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    cpu->regs.Y = SPC700_read8D(cpu, cpu->regs.TA + cpu->regs.X);
    cpu->regs.P.Z = +((cpu->regs.Y) == 0);
    cpu->regs.P.N = ((cpu->regs.Y) & 0x80) >> 7;
}


static void SPC700_opcode_FC(struct SPC700 *cpu) { // INC Y
    cpu->regs.opc_cycles = 2;
    // INS 36 ADDR MODE undefined
    cpu->regs.Y = (cpu->regs.Y + 1) & 0xFF;
    cpu->regs.P.Z = +((cpu->regs.Y) == 0);
    cpu->regs.P.N = ((cpu->regs.Y) & 0x80) >> 7;
}


static void SPC700_opcode_FD(struct SPC700 *cpu) { // MOV Y, A
    cpu->regs.opc_cycles = 2;
    cpu->regs.Y = cpu->regs.A;
    cpu->regs.P.Z = +((cpu->regs.Y) == 0);
    cpu->regs.P.N = ((cpu->regs.Y) & 0x80) >> 7;
}


static void SPC700_opcode_FE(struct SPC700 *cpu) { // DBNZ Y, r
    cpu->regs.opc_cycles = 4;
    cpu->regs.TR = SPC700_read8(cpu, cpu->regs.PC++);
    cpu->regs.PC &= 0xFFFF;
    // INS 28 ADDR MODE undefined
    cpu->regs.Y = (cpu->regs.Y - 1) & 0xFF;
    if (cpu->regs.Y != 0) {
        cpu->regs.PC = (cpu->regs.PC + (u32)(i8)cpu->regs.TR) & 0xFFFF;
        cpu->regs.opc_cycles += 2;
    }
}


static void SPC700_opcode_FF(struct SPC700 *cpu) { // STOP 
    cpu->regs.opc_cycles = 2;
    // INS 61 ADDR MODE 0
    cpu->STP = 1;
}


SPC700_ins_func spc700_decoded_opcodes[0x100] = {
&SPC700_opcode_00, &SPC700_opcode_01, &SPC700_opcode_02, &SPC700_opcode_03, &SPC700_opcode_04, &SPC700_opcode_05, &SPC700_opcode_06, &SPC700_opcode_07, 
&SPC700_opcode_08, &SPC700_opcode_09, &SPC700_opcode_0A, &SPC700_opcode_0B, &SPC700_opcode_0C, &SPC700_opcode_0D, &SPC700_opcode_0E, &SPC700_opcode_0F, 
&SPC700_opcode_10, &SPC700_opcode_11, &SPC700_opcode_12, &SPC700_opcode_13, &SPC700_opcode_14, &SPC700_opcode_15, &SPC700_opcode_16, &SPC700_opcode_17, 
&SPC700_opcode_18, &SPC700_opcode_19, &SPC700_opcode_1A, &SPC700_opcode_1B, &SPC700_opcode_1C, &SPC700_opcode_1D, &SPC700_opcode_1E, &SPC700_opcode_1F, 
&SPC700_opcode_20, &SPC700_opcode_21, &SPC700_opcode_22, &SPC700_opcode_23, &SPC700_opcode_24, &SPC700_opcode_25, &SPC700_opcode_26, &SPC700_opcode_27, 
&SPC700_opcode_28, &SPC700_opcode_29, &SPC700_opcode_2A, &SPC700_opcode_2B, &SPC700_opcode_2C, &SPC700_opcode_2D, &SPC700_opcode_2E, &SPC700_opcode_2F, 
&SPC700_opcode_30, &SPC700_opcode_31, &SPC700_opcode_32, &SPC700_opcode_33, &SPC700_opcode_34, &SPC700_opcode_35, &SPC700_opcode_36, &SPC700_opcode_37, 
&SPC700_opcode_38, &SPC700_opcode_39, &SPC700_opcode_3A, &SPC700_opcode_3B, &SPC700_opcode_3C, &SPC700_opcode_3D, &SPC700_opcode_3E, &SPC700_opcode_3F, 
&SPC700_opcode_40, &SPC700_opcode_41, &SPC700_opcode_42, &SPC700_opcode_43, &SPC700_opcode_44, &SPC700_opcode_45, &SPC700_opcode_46, &SPC700_opcode_47, 
&SPC700_opcode_48, &SPC700_opcode_49, &SPC700_opcode_4A, &SPC700_opcode_4B, &SPC700_opcode_4C, &SPC700_opcode_4D, &SPC700_opcode_4E, &SPC700_opcode_4F, 
&SPC700_opcode_50, &SPC700_opcode_51, &SPC700_opcode_52, &SPC700_opcode_53, &SPC700_opcode_54, &SPC700_opcode_55, &SPC700_opcode_56, &SPC700_opcode_57, 
&SPC700_opcode_58, &SPC700_opcode_59, &SPC700_opcode_5A, &SPC700_opcode_5B, &SPC700_opcode_5C, &SPC700_opcode_5D, &SPC700_opcode_5E, &SPC700_opcode_5F, 
&SPC700_opcode_60, &SPC700_opcode_61, &SPC700_opcode_62, &SPC700_opcode_63, &SPC700_opcode_64, &SPC700_opcode_65, &SPC700_opcode_66, &SPC700_opcode_67, 
&SPC700_opcode_68, &SPC700_opcode_69, &SPC700_opcode_6A, &SPC700_opcode_6B, &SPC700_opcode_6C, &SPC700_opcode_6D, &SPC700_opcode_6E, &SPC700_opcode_6F, 
&SPC700_opcode_70, &SPC700_opcode_71, &SPC700_opcode_72, &SPC700_opcode_73, &SPC700_opcode_74, &SPC700_opcode_75, &SPC700_opcode_76, &SPC700_opcode_77, 
&SPC700_opcode_78, &SPC700_opcode_79, &SPC700_opcode_7A, &SPC700_opcode_7B, &SPC700_opcode_7C, &SPC700_opcode_7D, &SPC700_opcode_7E, &SPC700_opcode_7F, 
&SPC700_opcode_80, &SPC700_opcode_81, &SPC700_opcode_82, &SPC700_opcode_83, &SPC700_opcode_84, &SPC700_opcode_85, &SPC700_opcode_86, &SPC700_opcode_87, 
&SPC700_opcode_88, &SPC700_opcode_89, &SPC700_opcode_8A, &SPC700_opcode_8B, &SPC700_opcode_8C, &SPC700_opcode_8D, &SPC700_opcode_8E, &SPC700_opcode_8F, 
&SPC700_opcode_90, &SPC700_opcode_91, &SPC700_opcode_92, &SPC700_opcode_93, &SPC700_opcode_94, &SPC700_opcode_95, &SPC700_opcode_96, &SPC700_opcode_97, 
&SPC700_opcode_98, &SPC700_opcode_99, &SPC700_opcode_9A, &SPC700_opcode_9B, &SPC700_opcode_9C, &SPC700_opcode_9D, &SPC700_opcode_9E, &SPC700_opcode_9F, 
&SPC700_opcode_A0, &SPC700_opcode_A1, &SPC700_opcode_A2, &SPC700_opcode_A3, &SPC700_opcode_A4, &SPC700_opcode_A5, &SPC700_opcode_A6, &SPC700_opcode_A7, 
&SPC700_opcode_A8, &SPC700_opcode_A9, &SPC700_opcode_AA, &SPC700_opcode_AB, &SPC700_opcode_AC, &SPC700_opcode_AD, &SPC700_opcode_AE, &SPC700_opcode_AF, 
&SPC700_opcode_B0, &SPC700_opcode_B1, &SPC700_opcode_B2, &SPC700_opcode_B3, &SPC700_opcode_B4, &SPC700_opcode_B5, &SPC700_opcode_B6, &SPC700_opcode_B7, 
&SPC700_opcode_B8, &SPC700_opcode_B9, &SPC700_opcode_BA, &SPC700_opcode_BB, &SPC700_opcode_BC, &SPC700_opcode_BD, &SPC700_opcode_BE, &SPC700_opcode_BF, 
&SPC700_opcode_C0, &SPC700_opcode_C1, &SPC700_opcode_C2, &SPC700_opcode_C3, &SPC700_opcode_C4, &SPC700_opcode_C5, &SPC700_opcode_C6, &SPC700_opcode_C7, 
&SPC700_opcode_C8, &SPC700_opcode_C9, &SPC700_opcode_CA, &SPC700_opcode_CB, &SPC700_opcode_CC, &SPC700_opcode_CD, &SPC700_opcode_CE, &SPC700_opcode_CF, 
&SPC700_opcode_D0, &SPC700_opcode_D1, &SPC700_opcode_D2, &SPC700_opcode_D3, &SPC700_opcode_D4, &SPC700_opcode_D5, &SPC700_opcode_D6, &SPC700_opcode_D7, 
&SPC700_opcode_D8, &SPC700_opcode_D9, &SPC700_opcode_DA, &SPC700_opcode_DB, &SPC700_opcode_DC, &SPC700_opcode_DD, &SPC700_opcode_DE, &SPC700_opcode_DF, 
&SPC700_opcode_E0, &SPC700_opcode_E1, &SPC700_opcode_E2, &SPC700_opcode_E3, &SPC700_opcode_E4, &SPC700_opcode_E5, &SPC700_opcode_E6, &SPC700_opcode_E7, 
&SPC700_opcode_E8, &SPC700_opcode_E9, &SPC700_opcode_EA, &SPC700_opcode_EB, &SPC700_opcode_EC, &SPC700_opcode_ED, &SPC700_opcode_EE, &SPC700_opcode_EF, 
&SPC700_opcode_F0, &SPC700_opcode_F1, &SPC700_opcode_F2, &SPC700_opcode_F3, &SPC700_opcode_F4, &SPC700_opcode_F5, &SPC700_opcode_F6, &SPC700_opcode_F7, 
&SPC700_opcode_F8, &SPC700_opcode_F9, &SPC700_opcode_FA, &SPC700_opcode_FB, &SPC700_opcode_FC, &SPC700_opcode_FD, &SPC700_opcode_FE, &SPC700_opcode_FF, 
};
